#cohort of year invested as column and top header as years since invested.
import pandas as pd
from collections import defaultdict

data_list = []
data_dict_mod = {}

years = [
    1928, 1929, 1930, 1931, 1932, 1933, 1934, 1935, 1936, 1937, 1938, 1939,
    1940, 1941, 1942, 1943, 1944, 1945, 1946, 1947, 1948, 1949, 1950, 1951,
    1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1960, 1961, 1962, 1963,
    1964, 1965, 1966, 1967, 1968, 1969, 1970, 1971, 1972, 1973, 1974, 1975,
    1976, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987,
    1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
    2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011,
    2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020
]

returns = {
    1928: 0.4553,
    1929: -0.083,
    1930: -0.2278,
    1931: -0.3486,
    1932: 0.0123,
    1933: 0.5509,
    1934: -0.0427,
    1935: 0.445,
    1936: 0.3048,
    1937: -0.3894,
    1938: 0.3136,
    1939: 0.0032,
    1940: -0.1139,
    1941: -0.1777,
    1942: 0.0829,
    1943: 0.1893,
    1944: 0.173,
    1945: 0.3355,
    1946: -0.1676,
    1947: -0.0916,
    1948: -0.0237,
    1949: 0.1954,
    1950: 0.2955,
    1951: 0.158,
    1952: 0.1623,
    1953: -0.0196,
    1954: 0.5181,
    1955: 0.3297,
    1956: 0.0595,
    1957: -0.1377,
    1958: 0.4087,
    1959: 0.1137,
    1960: -0.0138,
    1961: 0.2563,
    1962: -0.0981,
    1963: 0.2129,
    1964: 0.1511,
    1965: 0.1079,
    1966: -0.1283,
    1967: 0.2071,
    1968: 0.0662,
    1969: -0.137,
    1970: -0.0216,
    1971: 0.0984,
    1972: 0.1555,
    1973: -0.2053,
    1974: -0.3694,
    1975: 0.2787,
    1976: 0.1807,
    1977: -0.1348,
    1978: -0.0108,
    1979: 0.0717,
    1980: 0.1824,
    1981: -0.1502,
    1982: 0.1426,
    1983: 0.1913,
    1984: 0.0183,
    1985: 0.2768,
    1986: 0.1663,
    1987: 0.0216,
    1988: 0.124,
    1989: 0.2666,
    1990: -0.0846,
    1991: 0.2602,
    1992: 0.0448,
    1993: 0.0698,
    1994: -0.0123,
    1995: 0.3437,
    1996: 0.1973,
    1997: 0.3081,
    1998: 0.2678,
    1999: 0.1868,
    2000: -0.1239,
    2001: -0.147,
    2002: -0.2355,
    2003: 0.2608,
    2004: 0.0808,
    2005: 0.0144,
    2006: 0.1238,
    2007: 0.0263,
    2008: -0.4039,
    2009: 0.263,
    2010: 0.1318,
    2011: -0.0106,
    2012: 0.1382,
    2013: 0.3069,
    2014: 0.119,
    2015: 0.0126,
    2016: 0.1051,
    2017: 0.1948,
    2018: -0.0672,
    2019: 0.2945,
    2020: 0.1678
}

for year in years:
    years_since = 2021 - year

    cash_return = 10000

    for i in range(years_since):
        year_years_since = year + i
        for yr, return_pct in returns.items():
            if yr == year_years_since:
                pct_return = return_pct

        cash_return = cash_return + (cash_return * pct_return)
        data_list.append((year, cash_return, i))
        data_dict_mod[year, i] = [cash_return, i]

d = defaultdict(list)

for year, rt, i in data_list:
    d[year].append([rt, i])

df1 = pd.DataFrame.from_dict(d, orient='index').stack().reset_index()
df1[['column1', 'column2']] = pd.DataFrame(df1[0].tolist(), index=df1.index)

df1.to_csv(index=False)
#print(df1)

#print(cash_return)
#print(year)
#print(i)
